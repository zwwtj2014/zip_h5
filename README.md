# H5 文件压缩工具

<div align="center">
  <p>
    <strong>一个轻量级的在线文件压缩工具</strong>
  </p>
  <p>
    基于纯前端技术实现，无需服务器，保护用户隐私
  </p>
</div>

## 📋 项目简介

这是一个基于纯 HTML、CSS、JavaScript 开发的 H5 文件压缩工具，支持在浏览器端直接进行文件压缩，无需上传到服务器。专为移动设备优化，提供流畅的文件管理和压缩体验。

## ✨ 功能特性

### 🎯 核心功能
- ✅ **文件选择**: 支持点击选择和拖拽上传，多文件选择
- ✅ **文件管理**: 支持文件重命名、删除、新增
- ✅ **文件压缩**: 使用 JSZip 库进行本地压缩
- ✅ **文件下载**: 支持压缩包下载和重命名

### 💎 付费系统
- ✅ **免费下载**: 小于 10MB 的文件免费下载
- ✅ **手机号绑定**: 大文件免费下载需绑定手机号
- ✅ **会员系统**: 支持月度/年度会员，无限制下载
- ✅ **VIP特权**: 高速下载、无大小限制

### 🎨 用户体验
- ✅ **响应式设计**: 完美支持移动设备
- ✅ **动画效果**: 丰富的交互动画和过渡效果
- ✅ **进度提示**: 压缩过程可视化反馈
- ✅ **错误处理**: 友好的错误提示和异常处理

### 📊 数据分析
- ✅ **完整打点**: 用户行为全链路追踪
- ✅ **性能监控**: 页面性能和错误监控
- ✅ **业务指标**: 压缩率、下载转化等关键指标

## 🛠️ 技术栈

- **前端框架**: 原生 HTML5 + CSS3 + JavaScript (ES6+)
- **压缩引擎**: [JSZip](https://stuk.github.io/jszip/) v3.x - 客户端 ZIP 压缩
- **文件处理**: zww_uploader - 自定义文件上传组件
- **UI 组件**: 
  - custom-toast - 轻量级提示组件
  - 原生拖拽 API - 文件拖放支持
- **工具库**: util.js - 通用工具函数集
- **数据分析**: 自定义打点系统

## 📁 项目结构

```
zip_h5/
├── index.html              # 首页 - 文件选择界面
├── file-manager.html       # 文件管理页 - 编辑和整理
├── result.html             # 结果页 - 下载压缩包
├── css/
│   └── style.css          # 全局样式文件
├── js/
│   ├── analytics.js       # 数据打点和监控
│   ├── app.js            # 首页逻辑控制
│   ├── file-manager.js   # 文件管理功能
│   ├── compress.js       # 压缩核心逻辑
│   ├── result.js         # 结果页面处理
│   └── payment.js        # 付费系统集成
└── zww/                    # 自定义组件库
    ├── zww_uploader.js    # 文件上传组件
    ├── custom-toast.js    # 提示组件
    └── util.js            # 工具函数
```

## 🚀 使用流程

### 1. 📂 **选择文件** (index.html)
   - 🖱️ 点击选择或拖拽上传文件
   - 📎 支持批量多文件选择
   - 👁️ 实时文件预览和大小显示
   - 📱 移动端完美适配

### 2. ✏️ **管理文件** (file-manager.html)
   - 📋 清晰的文件列表展示
   - ✏️ 支持文件重命名操作
   - 🗑️ 快速删除不需要的文件
   - ➕ 继续添加新文件
   - 📊 实时统计文件数量和总大小

### 3. ⚙️ **压缩处理**
   - 🎯 一键开始压缩所有文件
   - 📊 动态进度条显示
   - ⏱️ 预估剩余时间
   - ✅ 压缩完成自动跳转

### 4. 💾 **下载文件** (result.html)
   - 📦 显示压缩包信息（大小、压缩率）
   - ✏️ 支持修改压缩包文件名
   - 🆓 小于 10MB 免费下载
   - 💎 大文件付费/会员下载

## 🔌 API 集成

### 打点上报
```javascript
// 基础URL
https://log.xiexinbao.com/user/log.gif

// 参数示例
?event=page_view&session_id=xxx&user_id=xxx&timestamp=xxx
```

### 订单创建
```javascript
// 接口地址
POST http://p.xiexinbao.com/zww_order/add

// 请求数据
{
  "file_count": 5,
  "original_size": 10485760,
  "compressed_size": 7340032,
  "compression_ratio": "30.0",
  "timestamp": 1640995200000
}
```

## 🌐 浏览器兼容性

- ✅ Chrome 60+
- ✅ Firefox 55+
- ✅ Safari 12+
- ✅ Edge 79+
- ✅ 移动端浏览器

## 📦 部署说明

### 快速部署

#### 1. 静态服务器部署
```bash
# 克隆项目
git clone https://github.com/your-repo/zip_h5.git

# 进入目录
cd zip_h5

# 使用任意静态服务器
python -m http.server 8000
# 或
npx serve
```

#### 2. Nginx 配置示例
```nginx
server {
    listen 80;
    server_name your-domain.com;
    root /var/www/zip_h5;
    
    location / {
        try_files $uri $uri/ /index.html;
    }
    
    # 开启 gzip 压缩
    gzip on;
    gzip_types text/css application/javascript;
}
```

#### 3. 环境要求
- **Web 服务器**: 任意静态文件服务器
- **HTTPS**: 强烈建议启用（某些 API 需要）
- **CDN**: 确保 JSZip 等外部库可访问
- **域名**: 建议绑定独立域名

## 💻 开发说明

### 📝 核心技术实现

#### 文件传递机制
- **存储方案**: 全局变量 + sessionStorage 混合存储
- **数据流**: 页面间通过内存和会话存储传递文件对象
- **适用场景**: 小到中等规模文件（建议 < 100MB）
- **优势**: 避免复杂的序列化，提高传输效率

#### 压缩实现
- **压缩引擎**: JSZip 3.x 纯前端压缩
- **压缩级别**: 默认标准压缩（可配置）
- **性能指标**: 
  - 内存占用：约 2-3 倍源文件大小
  - 压缩速度：10MB/秒（视设备性能）
- **进度反馈**: 实时进度条 + 百分比显示

#### 付费系统设计
- **免费额度**: < 10MB 文件免费下载
- **付费方案**:
  - 手机号绑定：单次大文件下载
  - 月度会员：￥9.9/月，无限下载
  - 年度会员：￥99/年，无限下载 + 高速通道
- **支付集成**: 支持微信、支付宝扫码支付

## ⚠️ 注意事项

### 🔴 重要提醒

1. **内存限制**: 
   - 浏览器内存上限约 2-4GB
   - 建议单文件 < 100MB
   - 总文件大小 < 500MB

2. **网络要求**:
   - CDN 资源需稳定访问
   - 建议配置本地备份
   - 离线环境暂不支持

3. **移动端限制**:
   - iOS Safari 文件 API 受限
   - 部分安卓浏览器不支持大文件
   - 建议使用 Chrome/Edge

4. **安全建议**:
   - 仅压缩可信文件
   - 避免敏感信息
   - 定期更新依赖库

5. **性能建议**:
   - 避免同时压缩多个大文件
   - 压缩时避免切换标签页
   - 保持设备充足电量

## 🎯 后续优化方向

### 🚀 性能优化
- [ ] Web Worker 多线程压缩
- [ ] 大文件分块处理（> 100MB）
- [ ] 流式压缩减少内存占用
- [ ] IndexedDB 本地缓存

### 🎯 功能增强
- [ ] 支持更多压缩格式（RAR、7Z）
- [ ] 文件夹压缩支持
- [ ] 压缩包预览功能
- [ ] 批量操作优化
- [ ] 压缩参数自定义

### 💡 用户体验
- [ ] PWA 离线应用
- [ ] 断点续传功能
- [ ] 深色模式支持
- [ ] 多语言国际化
- [ ] 快捷键支持

### 🔒 安全加固
- [ ] 文件类型白名单验证
- [ ] 恶意文件扫描
- [ ] 压缩包加密功能
- [ ] HTTPS 强制跳转

## 📬 联系方式

如有问题或建议，请通过以下方式联系：
- 提交 Issue: [GitHub Issues](https://github.com/your-repo/issues)
- 邮箱联系: dev@example.com

## 📄 许可证

MIT License - 详见 [LICENSE](LICENSE) 文件

## 🙏 致谢

- [JSZip](https://stuk.github.io/jszip/) - 强大的 JavaScript 压缩库
- 所有贡献者和用户的支持