# H5 文件压缩工具

## 项目简介

这是一个基于纯 HTML、CSS、JavaScript 开发的 H5 文件压缩工具，支持移动设备上选择文件进行压缩，并提供下载功能。

## 功能特性

### 核心功能
- ✅ **文件选择**: 支持点击选择和拖拽上传，多文件选择
- ✅ **文件管理**: 支持文件重命名、删除、新增
- ✅ **文件压缩**: 使用 JSZip 库进行本地压缩
- ✅ **文件下载**: 支持压缩包下载和重命名

### 付费系统
- ✅ **免费下载**: 小于 10MB 的文件免费下载
- ✅ **手机号绑定**: 大文件免费下载需绑定手机号
- ✅ **会员系统**: 支持月度/年度会员，无限制下载
- ✅ **VIP特权**: 高速下载、无大小限制

### 用户体验
- ✅ **响应式设计**: 完美支持移动设备
- ✅ **动画效果**: 丰富的交互动画和过渡效果
- ✅ **进度提示**: 压缩过程可视化反馈
- ✅ **错误处理**: 友好的错误提示和异常处理

### 数据分析
- ✅ **完整打点**: 用户行为全链路追踪
- ✅ **性能监控**: 页面性能和错误监控
- ✅ **业务指标**: 压缩率、下载转化等关键指标

## 技术栈

- **前端**: HTML5 + CSS3 + JavaScript (ES6+)
- **压缩库**: JSZip
- **上传库**: zww_uploader
- **提示组件**: custom-toast
- **工具库**: util.js

## 项目结构

```
zip_h5/
├── index.html              # 首页 - 文件选择
├── file-manager.html       # 文件管理页
├── result.html             # 结果页 - 下载
├── css/
│   └── style.css          # 样式文件
└── js/
    ├── analytics.js       # 数据打点
    ├── app.js            # 首页逻辑
    ├── file-manager.js   # 文件管理
    ├── compress.js       # 压缩功能
    ├── result.js         # 结果页面
    └── payment.js        # 付费系统
```

## 使用流程

1. **选择文件** (index.html)
   - 点击或拖拽选择文件
   - 支持多文件选择
   - 文件预览和大小显示

2. **管理文件** (file-manager.html)
   - 文件列表展示
   - 重命名、删除、新增文件
   - 文件统计信息

3. **压缩处理**
   - 一键开始压缩
   - 进度可视化提示
   - 压缩完成跳转

4. **下载文件** (result.html)
   - 压缩结果展示
   - 文件名编辑
   - 付费/免费下载选择

## API 集成

### 打点上报
```javascript
// 基础URL
https://log.xiexinbao.com/user/log.gif

// 参数示例
?event=page_view&session_id=xxx&user_id=xxx&timestamp=xxx
```

### 订单创建
```javascript
// 接口地址
POST http://p.xiexinbao.com/zww_order/add

// 请求数据
{
  "file_count": 5,
  "original_size": 10485760,
  "compressed_size": 7340032,
  "compression_ratio": "30.0",
  "timestamp": 1640995200000
}
```

## 浏览器兼容性

- ✅ Chrome 60+
- ✅ Firefox 55+
- ✅ Safari 12+
- ✅ Edge 79+
- ✅ 移动端浏览器

## 部署说明

1. **直接部署**: 将所有文件上传到 Web 服务器即可
2. **CDN 依赖**: 确保外部 JS 库能正常访问
3. **HTTPS**: 建议使用 HTTPS 以支持更多浏览器特性

## 开发说明

### 文件传递机制
- 使用全局变量 + sessionStorage 的简化方案
- 避免复杂的文件序列化问题
- 适合小到中等规模的文件处理

### 压缩实现
- 基于 JSZip 库进行客户端压缩
- 简化的进度提示，避免复杂的性能优化
- 内存占用：大约 2-3 倍文件大小

### 付费逻辑
- 参考 http://2.660.lv 的付费流程
- 10MB 文件大小分界线
- 手机号绑定 + VIP 会员两种方案

## 注意事项

1. **内存限制**: 大文件压缩时注意浏览器内存限制
2. **网络环境**: CDN 资源加载失败时的降级处理
3. **移动端**: iOS Safari 对文件操作有特殊限制
4. **安全性**: 当前版本未实现文件内容安全检查

## 后续优化方向

1. **性能优化**: 大文件分块处理、Worker 线程
2. **功能增强**: 更多压缩格式、批量操作
3. **用户体验**: 离线缓存、断点续传
4. **安全加固**: 文件类型验证、恶意文件检测

## 联系方式

如有问题或建议，请联系开发团队。